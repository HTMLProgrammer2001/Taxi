(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{160:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.historyOrderLoad=function(){return{type:n.ORDERS_LOAD_START}},t.historyOrderSuccess=function(e){return{type:n.ORDERS_LOAD_SUCCESS,payload:e}},t.historyOrderFail=function(e){return{type:n.ORDERS_LOAD_FAIL,error:e}},t.historyOrderAdd=function(e){return{type:n.ORDER_ADD,payload:e}},t.historyOrderChange=function(e){return{type:n.ORDER_CHANGE,payload:e}},t.historyOrderRemove=function(e){return{type:n.ORDER_REMOVE,payload:e}},t.historyDriverChange=function(e){return{type:n.FILTER_DRIVER_CHANGE,payload:e}},t.historyDateStartChange=function(e){return{type:n.FILTER_STARTDATE_CHANGE,payload:e}},t.historyDateEndChange=function(e){return{type:n.FILTER_ENDDATE_CHANGE,payload:e}},t.historyStatusChange=function(e){return{type:n.FILTER_STATUS_CHANGE,payload:e}},t.historySortFieldChange=function(e){return{type:n.SORT_FIELD_CHANGE,payload:e}},t.historySortDirectionChange=function(e){return{type:n.SORT_DIRECTION_CHANGE,payload:e}};var n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(114))},177:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=r(60);t.default=function(){return e.createElement("div",{className:"d-flex justify-content-between mb-3 p-2 align-items-center"},e.createElement("div",{className:"logo"},e.createElement("img",{src:r(178),alt:"Logo",className:"ml-3 logo-image"})),e.createElement("div",{className:"menu"},e.createElement(n.NavLink,{activeClassName:"active",className:"mr-3",to:"/profile"},"Профиль"),e.createElement(n.NavLink,{activeClassName:"active",className:"mr-3",to:"/history"},"История"),e.createElement(n.NavLink,{activeClassName:"active",to:"/dashboard",className:"mr-3"},"Доска объявлений"),e.createElement(n.NavLink,{to:"/",onClick:function(){firebaseProj.auth().signOut()},className:"mr-3"},"Выйти")))}}).call(this,r(5))},178:function(e,t){e.exports="/assets/images/logo.jpg"},404:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var i,l=e[Symbol.iterator]();!(n=(i=l.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&l.return&&l.return()}finally{if(o)throw a}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=c(r(160)),i=c(r(82)),l=r(112);function c(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}var u=function(t){function r(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e));return t.state={auto:[]},t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(r,t),o(r,[{key:"componentDidMount",value:function(){var e=this;firebaseProj.database().ref("/auto").once("value",(function(t){e.setState({auto:t.val()})}))}},{key:"render",value:function(){var t=this;return e.createElement("form",null,e.createElement("div",{className:"form-group"},e.createElement("label",{htmlFor:"driver"},"Водитель:"),e.createElement("select",{name:"driver",className:"custom-select mb-3",value:this.props.historyForm.driver||"",onChange:function(e){return t.props.historyFilterChange(a.historyDriverChange(e.target.value))}},e.createElement("option",{value:""},"Все"),Object.entries(this.state.auto).map((function(t){var r=n(t,2),o=r[0],a=r[1];return e.createElement("option",{value:o,key:o},a.name,"(ID: ",o,")")})))),e.createElement("div",{className:"form-group"},e.createElement("label",{htmlFor:"dateStart"},"Начиная с:"),e.createElement("input",{type:"date",className:"form-control mb-3",placeholder:"Date start",value:this.props.historyForm.dateStart||"",onChange:function(e){return t.props.historyFilterChange(a.historyDateStartChange(e.target.value))}})),e.createElement("div",{className:"form-group"},e.createElement("label",{htmlFor:"dateEnd"},"Заканчивая до:"),e.createElement("input",{type:"date",className:"form-control mb-3",placeholder:"Date end",value:this.props.historyForm.dateEnd||"",onChange:function(e){return t.props.historyFilterChange(a.historyDateEndChange(e.target.value))}})),e.createElement("div",{className:"form-group"},e.createElement("label",{htmlFor:"orderStatus"},"Статус:"),e.createElement("select",{className:"custom-select mb-3",value:this.props.historyForm.status||"",onChange:function(e){return t.props.historyFilterChange(a.historyStatusChange(e.target.value))}},e.createElement("option",{value:""},"Все"),[i.ORDER_FREE,i.ORDER_WAIT,i.ORDER_AUTO,i.ORDER_MOVE,i.ORDER_PAY,i.ORDER_FINISHED].map((function(t,r){return e.createElement("option",{value:t,key:r},t)})))),e.createElement("div",{className:"form-group"},e.createElement("label",{htmlFor:"sortBy"},"Сортировать по:"),e.createElement("select",{className:"custom-select mb-3",value:this.props.historyForm.sortBy||"",onChange:function(e){return t.props.historyFilterChange(a.historySortFieldChange(e.target.value))}},e.createElement("option",{value:"orderCreate"},"Дате создания"),e.createElement("option",{value:"status"},"Статусу"),e.createElement("option",{value:"orderID"},"ID"))),e.createElement("div",{className:"form-group"},e.createElement("label",{htmlFor:"sortDir"},"Порядок сортировки:"),e.createElement("div",{className:"custom-control custom-radio"},e.createElement("input",{type:"radio",className:"custom-control-input",name:"sortDir",value:"ASC",defaultChecked:"ASC"===this.props.historyForm.sortDir,onClick:function(e){return t.props.historyFilterChange(a.historySortDirectionChange(e.target.form.sortDir.value))},style:{zIndex:9999}}),e.createElement("label",{htmlFor:"sortDir",className:"custom-control-label"},"ASC")),e.createElement("div",{className:"custom-control custom-radio"},e.createElement("input",{type:"radio",className:"custom-control-input",name:"sortDir",value:"DESC",onClick:function(e){return t.props.historyFilterChange(a.historySortDirectionChange(e.target.form.sortDir.value))},defaultChecked:"DESC"===this.props.historyForm.sortDir,style:{zIndex:9999}}),e.createElement("label",{className:"custom-control-label",htmlFor:"sortDir"},"DESC"))))}}]),r}(e.Component);t.default=(0,l.connect)((function(e){return{historyForm:e.history.form}}),(function(e){return{historyFilterChange:function(t){return e(t)}}}))(u)}).call(this,r(5))},405:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n,o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(406),l=(n=i)&&n.__esModule?n:{default:n},c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(160)),u=r(112);var s=function(t){function r(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(r.__proto__||Object.getPrototypeOf(r)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(r,t),a(r,[{key:"componentDidMount",value:function(){this.props.loadOrders()}},{key:"DateConvert",value:function(e,t){return["orderCreate","orderAccept","orderFinished"].includes(e)?new Date(t).toLocaleString():t}},{key:"fetchDate",value:function(e){var t=JSON.stringify(this.props.historyOrders.val,this.DateConvert);switch(e){case"Excel":fetch("http://taxi/api/excel.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},mode:"cors",body:"orders="+t}).then((function(e){e.blob().then((function(e){var t=document.createElement("a");t.href=URL.createObjectURL(e),t.download="history"+ +new Date+".xlsx",document.body.appendChild(t),t.click(),t.remove()}))}));break;case"PDF":fetch("http://taxi/api/pdf.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},mode:"cors",body:"orders="+t}).then((function(e){e.blob().then((function(e){var t=document.createElement("a");t.href=URL.createObjectURL(e),t.download="history"+ +new Date+".pdf",document.body.appendChild(t),t.click(),t.remove()}))}))}}},{key:"render",value:function(){var t=this;return this.props.historyOrders.val.length?e.createElement("div",null,e.createElement("div",{className:"row d-flex"},e.createElement("div",{className:"btn btn-primary m-3",onClick:function(){return t.fetchDate("Excel")}},"Excel"),e.createElement("div",{className:"btn btn-primary m-3",onClick:function(){return t.fetchDate("PDF")}},"PDF")),this.props.historyOrders.val.map((function(t){return e.createElement(l.default,{order:t,key:t.orderID})}))):e.createElement("div",null,"Записей по данному фильтру не найдено.")}}]),r}(e.Component);t.default=(0,u.connect)((function(e){var t=e.history.orders.val;return t=(t=(t=(t=t.filter((function(t){return""===e.history.form.driver||+e.history.form.driver==+t.autoID}))).filter((function(t){return(!e.history.form.dateStart||t.orderCreate>Date.parse(e.history.form.dateStart))&&(!e.history.form.dateEnd||t.orderCreate<Date.parse(e.history.form.dateEnd))}))).filter((function(t){return!e.history.form.status||t.status==e.history.form.status}))).sort((function(t,r){return"ASC"===e.history.form.sortDir?t[e.history.form.sortBy]>r[e.history.form.sortBy]:t[e.history.form.sortBy]<r[e.history.form.sortBy]})),{historyOrders:o({},e.history.orders,{val:t})}}),(function(e){return{loadOrders:function(){e((function(e){firebaseProj.database().ref("/orders").on("child_changed",(function(t){t.val().user===firebaseProj.auth().currentUser.uid&&e(c.historyOrderChange(o({orderID:t.key},t.val())))})),firebaseProj.database().ref("/orders").on("child_added",(function(t){t.val().user===firebaseProj.auth().currentUser.uid&&e(c.historyOrderAdd(o({orderID:t.key},t.val())))})),firebaseProj.database().ref("/orders").on("child_removed",(function(t){t.val().user===firebaseProj.auth().currentUser.uid&&e(c.historyOrderRemove(t.key))}))}))}}}))(s)}).call(this,r(5))},406:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(82));t.default=function(t){return e.createElement("div",{className:"card",key:t.order.orderID},e.createElement("div",{className:"card-body"},e.createElement("div",null,"Заказ №: ",t.order.orderID),e.createElement("div",null,"Начальный адресс: ",t.order.start),e.createElement("div",null,"Конечный адресс: ",t.order.destination),e.createElement("div",null,"Статус: ",t.order.status),e.createElement("div",null,"Создан: ",new Date(t.order.orderCreate).toLocaleString()),function(t){if(t.status!==n.ORDER_FREE)return t.status===n.ORDER_FINISHED?e.createElement("div",null,e.createElement("div",null,"ID водителя: ",t.autoID),e.createElement("div",null,"Дата принятия: ",new Date(t.orderAccept).toLocaleString()),e.createElement("div",null,"Дата завершения: ",new Date(t.orderFinished).toLocaleString()),e.createElement("div",null,"Цена: ",t.price," грн")):e.createElement("div",null,e.createElement("div",null,"ID водителя: ",t.autoID),e.createElement("div",null,"Дата принятия: ",new Date(t.orderAccept).toLocaleString()))}(t.order)))}}).call(this,r(5))},410:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=i(r(80)),o=i(r(404)),a=i(r(405));function i(e){return e&&e.__esModule?e:{default:e}}t.default=(0,n.default)((function(){return e.createElement("div",{className:"container"},e.createElement("div",{className:"row"},e.createElement("div",{className:"col-sm-8"},e.createElement(a.default,null)),e.createElement("div",{className:"col-sm-4"},e.createElement(o.default,null))))}))}).call(this,r(5))},80:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n,o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(177),i=(n=a)&&n.__esModule?n:{default:n};r(79),r(179);var l=r(60);t.default=function(t){return function(r){function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,r),o(n,[{key:"render",value:function(){return firebaseProj.auth().currentUser?e.createElement(e.Fragment,null,e.createElement(i.default,null),e.createElement(t,null)):e.createElement(l.Redirect,{to:"/"})}}]),n}(e.Component)}}).call(this,r(5))},82:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AUTO_FREE="Свободен",t.AUTO_ORDER="В пути к заказу",t.AUTO_WAIT="В ожидании",t.AUTO_MOVE="Движется",t.AUTO_PAY="Оплачивается",t.ORDER_FREE="Свободен",t.ORDER_WAIT="В ожидании",t.ORDER_AUTO="В пути к машине",t.ORDER_MOVE="Движется",t.ORDER_PAY="Оплачивается",t.ORDER_FINISHED="Завершен",t.EVENT_TRAVEL="InMove",t.EVENT_PAY="Pay",t.EVENT_WAIT="Wait",t.COST_PER_KM=10,t.COST_BUSY_PER_KM=12.5,t.COST_OFFCITY_PER_KM=20}}]);