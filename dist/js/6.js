(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{121:function(e,t){e.exports="/assets/images/danger.png"},122:function(e,t){e.exports="/assets/images/defAvatar.png"},15:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}}(a(180)).initializeApp({apiKey:"AIzaSyDdJjjkx2zXC_pIjlW7MtTgU2HvYFrqIqY",authDomain:"forwork-1579542004155.firebaseapp.com",databaseURL:"https://forwork-1579542004155.firebaseio.com",projectId:"forwork-1579542004155",storageBucket:"forwork-1579542004155.appspot.com",messagingSenderId:"591558800067",appId:"1:591558800067:web:41e749971b0784e9302876",measurementId:"G-BBCZS5L5MK"});t.default=n},177:function(e,t){e.exports="/assets/images/success.png"},178:function(e,s,l){"use strict";(function(e){Object.defineProperty(s,"__esModule",{value:!0});var t,a=l(61),n=l(31),r=l(15),o=(t=r)&&t.__esModule?t:{default:t};s.default=function(){return e.createElement("div",{className:"d-flex justify-content-between mb-3 p-2 align-items-center"},e.createElement("div",{className:"logo"},e.createElement("img",{src:l(179),alt:"Logo",className:"ml-3 logo-image"})),e.createElement("div",{className:"menu"},e.createElement(a.NavLink,{activeClassName:"active",className:"mr-3",to:"/profile"},"Профиль"),e.createElement(a.NavLink,{activeClassName:"active",className:"mr-3",to:"/history"},"История"),e.createElement(a.NavLink,{activeClassName:"active",to:"/dashboard",className:"mr-3"},"Доска объявлений"),e.createElement("div",{className:"dropdown"},e.createElement("div",{className:"menu-account dropdown-toggle","data-toggle":"dropdown"},e.createElement("img",{src:o.default.auth().currentUser.photoURL||l(122),className:"menu-account-photo"}),e.createElement("div",{className:"menu-account-info"},e.createElement("span",{className:"menu-account-info-name"},o.default.auth().currentUser.displayName))),e.createElement("ul",{className:"dropdown-menu menu-account-content"},e.createElement("li",{className:"dropdown-menu-item menu-account-item"},e.createElement(a.NavLink,{to:"/profile"},"Профиль")),e.createElement("li",{className:"dropdown-menu-item menu-account-item"},e.createElement(a.NavLink,{to:"/profile#updateForm"},"Обновить аккаунт")),e.createElement("li",{className:"dropdown-menu-item menu-account-item"},e.createElement(a.NavLink,{to:"/",onClick:function(){o.default.auth().signOut().catch(function(e){return(0,n.showDangerMessage)(e.message)})}},"Выйти"))))))}}).call(this,l(5))},179:function(e,t){e.exports="/assets/images/logo.jpg"},189:function(e,f,d){"use strict";(function(e){Object.defineProperty(f,"__esModule",{value:!0});var t=function(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e};function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a,s=d(31),r=d(15),l=(a=r)&&a.__esModule?a:{default:a};function o(e){return function(){var l=e.apply(this,arguments);return new Promise(function(o,s){return function t(e,a){try{var n=l[e](a),r=n.value}catch(e){return void s(e)}if(!n.done)return Promise.resolve(r).then(function(e){t("next",e)},function(e){t("throw",e)});o(r)}("next")})}}d(86);var u,i=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(c,e.Component),t(c,[{key:"render",value:function(){return e.createElement("div",{className:"overflow-hidden col-sm-3 col-offset-2"},e.createElement("img",{src:l.default.auth().currentUser.photoURL||d(122),className:"w-100 mb-3",alt:""}),e.createElement("input",{type:"file",className:"d-none",id:"userAva",onChange:this.onPhotoChange}),e.createElement("label",{onClick:this.onUpdateButClick,className:"btn-primary btn btn-block",htmlFor:"userAva"},this.state.message?this.state.message:"Обновить фото"),e.createElement("div",{className:"btn btn-danger btn-block mt-1",onClick:this.onDeleteButClick},"Удалить фото"))}},{key:"onUpdateButClick",value:(u=o(regeneratorRuntime.mark(function e(t){var a,n,r,o=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.updated){e.next=4;break}return e.abrupt("return");case 4:t.preventDefault();case 5:return a=this.state.file,n=l.default.storage().ref("/"+l.default.auth().currentUser.uid+a.name.slice(a.name.lastIndexOf("."))),e.next=8,n.put(a);case 8:return e.next=10,n.getDownloadURL();case 10:r=e.sent,l.default.auth().currentUser.updateProfile({photoURL:r}).then(function(){o.setState({updated:!1,message:""}),o.props.onAvaChange(),(0,s.showSuccessMessage)("Аватар изменен")});case 12:case"end":return e.stop()}},e,this)})),function(e){return u.apply(this,arguments)})},{key:"onPhotoChange",value:function(e){var t=e.target.files[0];return t.type.includes("image")?5242880<t.size?((0,s.showDangerMessage)("Файл превышает максимальный размер"),void this.setState({message:"",updated:!1})):void this.setState({message:"Загрузить",file:t,updated:!0}):((0,s.showDangerMessage)("Файл должен быть фотографией"),void this.setState({message:"",updated:!1}))}},{key:"onDeleteButClick",value:function(){var e=this;l.default.auth().currentUser.updateProfile({photoURL:""}).then(function(){e.props.onAvaChange(),(0,s.showSuccessMessage)("Аватар удален")})}}]),c);function c(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,e));return t.onPhotoChange=t.onPhotoChange.bind(t),t.onUpdateButClick=t.onUpdateButClick.bind(t),t.onDeleteButClick=t.onDeleteButClick.bind(t),t.state={file:null,message:"",updated:!1},t}f.default=i}).call(this,d(5))},31:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=null,r=document.querySelector("#message-window"),o=a(177),s=a(121);function l(){r.classList.remove("show"),r.classList.remove("hide"),r.classList.remove("alert-success"),r.classList.remove("alert-danger"),n&&clearTimeout(n),n=setTimeout(function(){r.classList.add("hide")},3500)}t.showSuccessMessage=function(e){l(),r.querySelector(".img").src=o,r.querySelector(".text").textContent=e,r.classList.add("alert-success"),r.querySelector(".img").onload=function(){r.classList.add("show")}},t.showDangerMessage=function(e){l(),r.querySelector(".img").src=s,r.querySelector(".text").textContent=e,r.classList.add("alert-danger"),r.querySelector(".img").onload=function(){r.classList.add("show")}}},391:function(e,r,o){"use strict";(function(t){Object.defineProperty(r,"__esModule",{value:!0});var e,a=o(15),n=(e=a)&&e.__esModule?e:{default:e};r.default=function(){var e=n.default.auth().currentUser;return t.createElement("table",{className:"table table-bordered"},t.createElement("tbody",null,t.createElement("tr",null,t.createElement("td",null,"Имя"),t.createElement("td",null,e.displayName)),t.createElement("tr",null,t.createElement("td",null,"Email"),t.createElement("td",null,e.email)),t.createElement("tr",null,t.createElement("td",null,"Email подтвержден"),e.emailVerified?t.createElement("td",{className:"text-success"},"Подтвержден"):t.createElement("td",{className:"text-danger"},"Не подтвержден"))))}}).call(this,o(5))},392:function(e,d,m){"use strict";(function(e){Object.defineProperty(d,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},t=function(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e};function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=r(m(81)),u=m(31),i=r(m(15));function r(e){return e&&e.__esModule?e:{default:e}}function o(e){return function(){var l=e.apply(this,arguments);return new Promise(function(o,s){return function t(e,a){try{var n=l[e](a),r=n.value}catch(e){return void s(e)}if(!n.done)return Promise.resolve(r).then(function(e){t("next",e)},function(e){t("throw",e)});o(r)}("next")})}}m(160),m(86);var l,c=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(f,e.Component),t(f,[{key:"render",value:function(){return e.createElement("form",{onSubmit:this.updateUser},e.createElement(a.default,{error:this.state.updateError}),e.createElement("input",{type:"text",name:"userName",onInput:this.onFormChange,value:this.state.fieldsValue.userName,className:"form-control",placeholder:"Введите новое имя"}),e.createElement("label",{className:"text-danger text-small d-block mb-3"},this.state.fieldsError.userName),e.createElement("div",{className:"custom-file mb-3"},e.createElement("input",{type:"file",accept:"image",name:"userPhoto",onChange:this.onFormChange,className:"custom-file-input",placeholder:"Выберите фото"}),this.state.fieldsError.userPhoto?e.createElement("label",{className:"text-danger text-small custom-file-label"},this.state.fieldsError.userPhoto):e.createElement("label",{className:"custom-file-label"},"Выберите фото")),e.createElement("input",{type:"password",name:"userPassword",onInput:this.onFormChange,value:this.state.fieldsValue.userPassword,className:"form-control",placeholder:"Введите новый пароль"}),e.createElement("label",{className:"text-danger text-small d-block mb-3"},this.state.fieldsError.userPassword),e.createElement("input",{type:"password",name:"confirmPassword",onInput:this.onFormChange,value:this.state.fieldsValue.confirmPassword,className:"form-control",placeholder:"Подтвердите пароль"}),e.createElement("label",{className:"text-danger text-small d-block mb-3"},this.state.fieldsError.confirmPassword),e.createElement("button",{type:"submit",name:"updating",className:"btn btn-primary"},"Обновить"))}},{key:"onFormChange",value:function(e){var r=e.target,o=r.files?r.files[0]:r.value;this.setState(function(e){return{fieldsValue:s({},e.fieldsValue,(t={},a=r.name,n=o,a in t?Object.defineProperty(t,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[a]=n,t))};var t,a,n})}},{key:"updateUser",value:(l=o(regeneratorRuntime.mark(function e(t){var a,n,r,o,s,l=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),a=this.testForm(),Object.keys(a).length)return this.setState({fieldsError:a}),(0,u.showDangerMessage)("Ошибки заполнения формы"),e.abrupt("return");e.next=6;break;case 6:if(n=i.default.auth().currentUser,r=n.photoURL,o=this.state.fieldsValue.userName?this.state.fieldsValue.userName:n.displayName,this.state.fieldsValue.userPhoto)return s=i.default.storage().ref("/"+n.uid+this.state.fieldsValue.userPhoto.name.slice(this.state.fieldsValue.userPhoto.name.lastIndexOf("."))),e.next=11,s.put(this.state.fieldsValue.userPhoto);e.next=14;break;case 11:return e.next=13,s.getDownloadURL();case 13:r=e.sent;case 14:i.default.auth().currentUser.updateProfile({displayName:o,photoURL:r}).then(function(){return l.state.fieldsValue.userPassword?i.default.auth().currentUser.updatePassword(l.state.fieldsValue.userPassword):Promise.resolve()}).then(function(){l.props.onProfileChange(),(0,u.showSuccessMessage)("Профиль обновлен"),l.setState({fieldsValue:{},fieldsError:{},updateError:""})}).catch(function(e){(0,u.showDangerMessage)("Ошибка обновления"),l.setState({updateError:e.message})});case 15:case"end":return e.stop()}},e,this)})),function(e){return l.apply(this,arguments)})},{key:"testForm",value:function(){var e={};return this.state.fieldsValue.userName&&this.state.fieldsValue.userName<3&&(e.userName="Минимальная длина имени 3 символа"),this.state.fieldsValue.userPassword&&this.state.fieldsValue.userPassword.length<8&&(e.userPassword="Минимальная длина пароля 8 символов"),this.state.fieldsValue.confirmPassword!==this.state.fieldsValue.userPassword&&(e.confirmPassword="Пароли не совпадают"),this.state.fieldsValue.userPhoto&&(this.state.fieldsValue.userPhoto.type.includes("image")||(e.userPhoto="Файл должен быть фотографией"),5242880<this.state.fieldsValue.userPhoto.size&&(e.userPhoto="Превышен максимальный размер фото(5Мб)")),e}}]),f);function f(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,e));return t.onFormChange=t.onFormChange.bind(t),t.updateUser=t.updateUser.bind(t),t.state={fieldsValue:{},fieldsError:{},updateError:null},t}d.default=c}).call(this,m(5))},410:function(e,f,d){"use strict";(function(e,t){Object.defineProperty(f,"__esModule",{value:!0});var a=function(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e};function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}d(185),d(79);var r=u(d(80)),o=u(d(189)),s=u(d(391)),l=u(d(392));function u(e){return e&&e.__esModule?e:{default:e}}var i=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(c,e.Component),a(c,[{key:"componentDidMount",value:function(){location.hash&&t(location.hash).modal("show")}}]),a(c,[{key:"render",value:function(){return e.createElement("div",{className:"container my-5 row justify-content-center"},e.createElement(o.default,{onAvaChange:this.onProfileChange}),e.createElement("div",{className:"col-sm-9 col-md-6"},e.createElement(s.default,null),e.createElement("a",{className:"btn btn-link","data-toggle":"modal",href:"#updateForm"},"Обновить профиль"),e.createElement("div",{className:"modal",role:"dialog",id:"updateForm"},e.createElement("div",{className:"modal-dialog",role:"document"},e.createElement("div",{className:"modal-content"},e.createElement("div",{className:"modal-header d-flex justify-content-end"},e.createElement("span",{"data-dismiss":"modal",className:"cursor"},"×")),e.createElement("div",{className:"modal-body"},e.createElement(l.default,{onProfileChange:this.onProfileChange})))))))}},{key:"onProfileChange",value:function(){this.setState(function(e){return{update:!e.update}})}}]),c);function c(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,e));return t.onProfileChange=t.onProfileChange.bind(t),t.state={update:!1},t}f.default=(0,r.default)(i)}).call(this,d(5),d(85))},80:function(e,t,u){"use strict";(function(a){Object.defineProperty(t,"__esModule",{value:!0});var n=function(e,t,a){return t&&r(e.prototype,t),a&&r(e,a),e};function r(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=e(u(178)),s=e(u(15));u(79),u(181);var l=u(61);function e(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),n(t,[{key:"render",value:function(){return s.default.auth().currentUser?a.createElement(a.Fragment,null,a.createElement(o.default,null),a.createElement(e,null)):a.createElement(l.Redirect,{to:"/"})}}]),t;function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}}}).call(this,u(5))},81:function(e,n,r){"use strict";(function(t){Object.defineProperty(n,"__esModule",{value:!0});var a=r(61);n.default=function(e){return e.error?t.createElement("div",{className:"alert alert-danger"},e.error):""===e.error&&e.successRedirect?t.createElement(a.Redirect,{to:e.successRedirect,push:!0}):null}}).call(this,r(5))}}]);