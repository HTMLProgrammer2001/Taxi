(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{122:function(e,t){e.exports="/assets/images/danger.png"},15:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(r(185)).initializeApp({apiKey:"AIzaSyDdJjjkx2zXC_pIjlW7MtTgU2HvYFrqIqY",authDomain:"forwork-1579542004155.firebaseapp.com",databaseURL:"https://forwork-1579542004155.firebaseio.com",projectId:"forwork-1579542004155",storageBucket:"forwork-1579542004155.appspot.com",messagingSenderId:"591558800067",appId:"1:591558800067:web:41e749971b0784e9302876",measurementId:"G-BBCZS5L5MK"});t.default=a},182:function(e,t){e.exports="/assets/images/success.png"},183:function(e,o,l){"use strict";(function(e){Object.defineProperty(o,"__esModule",{value:!0});var t,r=l(65),a=l(35),n=l(15),s=(t=n)&&t.__esModule?t:{default:t};o.default=function(){return e.createElement("div",{className:"d-flex justify-content-between mb-3 p-2 align-items-center"},e.createElement("div",{className:"logo"},e.createElement("img",{src:l(184),alt:"Logo",className:"ml-3 logo-image"})),e.createElement("div",{className:"menu"},e.createElement(r.NavLink,{activeClassName:"active",className:"mr-3",to:"/profile"},"Профиль"),e.createElement(r.NavLink,{activeClassName:"active",className:"mr-3",to:"/history"},"История"),e.createElement(r.NavLink,{activeClassName:"active",to:"/dashboard",className:"mr-3"},"Доска объявлений"),e.createElement(r.NavLink,{to:"/",onClick:function(){s.default.auth().signOut().catch(function(e){return(0,a.showDangerMessage)(e.message)})},className:"mr-3"},"Выйти")))}}).call(this,l(5))},184:function(e,t){e.exports="/assets/images/logo.jpg"},197:function(e,t,r){"use strict";r(127)},198:function(e,f,d){"use strict";(function(e){Object.defineProperty(f,"__esModule",{value:!0});var t=function(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e};function a(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var r,o=d(35),n=d(15),l=(r=n)&&r.__esModule?r:{default:r};function s(e){return function(){var l=e.apply(this,arguments);return new Promise(function(s,o){return function t(e,r){try{var a=l[e](r),n=a.value}catch(e){return void o(e)}if(!a.done)return Promise.resolve(n).then(function(e){t("next",e)},function(e){t("throw",e)});s(n)}("next")})}}d(87);var u,i=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(c,e.Component),t(c,[{key:"render",value:function(){return e.createElement("div",{className:"overflow-hidden col-sm-3 col-offset-2"},e.createElement("img",{src:l.default.auth().currentUser.photoURL||d(400),className:"w-100 mb-3",alt:""}),e.createElement("input",{type:"file",className:"d-none",id:"userAva",onChange:this.onPhotoChange}),e.createElement("label",{onClick:this.onButClick,className:"btn-primary btn btn-block",htmlFor:"userAva"},this.state.message?this.state.message:"Обновить фото"))}},{key:"onButClick",value:(u=s(regeneratorRuntime.mark(function e(t){var r,a,n,s=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.updated){e.next=4;break}return e.abrupt("return");case 4:t.preventDefault();case 5:return r=this.state.file,a=l.default.storage().ref("/"+l.default.auth().currentUser.uid+r.name.slice(r.name.lastIndexOf("."))),e.next=8,a.put(r);case 8:return e.next=10,a.getDownloadURL();case 10:n=e.sent,l.default.auth().currentUser.updateProfile({photoURL:n}).then(function(){s.setState({updated:!1,message:""}),s.props.onAvaChange(),(0,o.showSuccessMessage)("Аватар изменен")});case 12:case"end":return e.stop()}},e,this)})),function(e){return u.apply(this,arguments)})},{key:"onPhotoChange",value:function(e){var t=e.target.files[0];return t.type.includes("image")?5242880<t.size?((0,o.showDangerMessage)("Файл превышает максимальный размер"),void this.setState({message:"",updated:!1})):void this.setState({message:"Загрузить",file:t,updated:!0}):((0,o.showDangerMessage)("Файл должен быть фотографией"),void this.setState({message:"",updated:!1}))}}]),c);function c(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,e));return t.onPhotoChange=t.onPhotoChange.bind(t),t.onButClick=t.onButClick.bind(t),t.state={file:null,message:"",updated:!1},t}f.default=i}).call(this,d(5))},35:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=null,n=document.querySelector("#message-window");function s(){n.classList.remove("show"),n.classList.remove("hide"),n.classList.remove("alert-success"),n.classList.remove("alert-danger"),a&&clearTimeout(a),a=setTimeout(function(){n.classList.add("hide")},5e3)}t.showSuccessMessage=function(e){s(),n.querySelector(".img").src=r(182),n.querySelector(".text").textContent=e,n.classList.add("alert-success"),n.classList.add("show")},t.showDangerMessage=function(e){s(),n.querySelector(".img").src=r(122),n.querySelector(".text").textContent=e,n.classList.add("alert-danger"),n.classList.add("show")}},400:function(e,t){e.exports="/assets/images/defAvatar.png"},401:function(e,n,s){"use strict";(function(t){Object.defineProperty(n,"__esModule",{value:!0});var e,r=s(15),a=(e=r)&&e.__esModule?e:{default:e};n.default=function(){var e=a.default.auth().currentUser;return t.createElement("table",{className:"table table-bordered"},t.createElement("tbody",null,t.createElement("tr",null,t.createElement("td",null,"Имя"),t.createElement("td",null,e.displayName)),t.createElement("tr",null,t.createElement("td",null,"Email"),t.createElement("td",null,e.email)),t.createElement("tr",null,t.createElement("td",null,"Email подтвержден"),e.emailVerified?t.createElement("td",{className:"text-success"},"Подтвержден"):t.createElement("td",{className:"text-danger"},"Не подтвержден"))))}}).call(this,s(5))},402:function(e,d,m){"use strict";(function(e){Object.defineProperty(d,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},t=function(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e};function a(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var r=n(m(85)),u=m(35),i=n(m(15));function n(e){return e&&e.__esModule?e:{default:e}}function s(e){return function(){var l=e.apply(this,arguments);return new Promise(function(s,o){return function t(e,r){try{var a=l[e](r),n=a.value}catch(e){return void o(e)}if(!a.done)return Promise.resolve(n).then(function(e){t("next",e)},function(e){t("throw",e)});s(n)}("next")})}}m(164),m(87);var l,c=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(f,e.Component),t(f,[{key:"render",value:function(){return e.createElement("form",{onSubmit:this.updateUser},e.createElement(r.default,{error:this.state.updateError,successMessage:"Профиль обновлен"}),e.createElement("input",{type:"text",name:"userName",onInput:this.onFormChange,value:this.state.fieldsValue.userName,className:"form-control",placeholder:"Введите новое имя"}),e.createElement("label",{className:"text-danger text-small d-block mb-3"},this.state.fieldsError.userName),e.createElement("div",{className:"custom-file mb-3"},e.createElement("input",{type:"file",accept:"image",name:"userPhoto",onChange:this.onFormChange,className:"custom-file-input",placeholder:"Выберите фото"}),this.state.fieldsError.userPhoto?e.createElement("label",{className:"text-danger text-small custom-file-label"},this.state.fieldsError.userPhoto):e.createElement("label",{className:"custom-file-label"},"Выберите фото")),e.createElement("input",{type:"password",name:"userPassword",onInput:this.onFormChange,value:this.state.fieldsValue.userPassword,className:"form-control",placeholder:"Введите новый пароль"}),e.createElement("label",{className:"text-danger text-small d-block mb-3"},this.state.fieldsError.userPassword),e.createElement("input",{type:"password",name:"confirmPassword",onInput:this.onFormChange,value:this.state.fieldsValue.confirmPassword,className:"form-control",placeholder:"Подтвердите пароль"}),e.createElement("label",{className:"text-danger text-small d-block mb-3"},this.state.fieldsError.confirmPassword),e.createElement("button",{type:"submit",name:"updating",className:"btn btn-primary"},"Обновить"))}},{key:"onFormChange",value:function(e){var n=e.target,s=n.files?n.files[0]:n.value;this.setState(function(e){return{fieldsValue:o({},e.fieldsValue,(t={},r=n.name,a=s,r in t?Object.defineProperty(t,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[r]=a,t))};var t,r,a})}},{key:"updateUser",value:(l=s(regeneratorRuntime.mark(function e(t){var r,a,n,s,o,l=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),r=this.testForm(),Object.keys(r).length)return this.setState({fieldsError:r}),(0,u.showDangerMessage)("Ошибки заполнения формы"),e.abrupt("return");e.next=6;break;case 6:if(a=i.default.auth().currentUser,n="",s=this.state.fieldsValue.userName?this.state.fieldsValue.userName:a.displayName,this.state.fieldsValue.userPhoto)return o=i.default.storage().ref("/"+a.uid+this.state.fieldsValue.userPhoto.name.slice(this.state.fieldsValue.userPhoto.name.lastIndexOf("."))),e.next=11,o.put(this.state.fieldsValue.userPhoto);e.next=14;break;case 11:return e.next=13,o.getDownloadURL();case 13:n=e.sent;case 14:i.default.auth().currentUser.updateProfile({displayName:s,photoURL:n}).then(function(){return l.state.fieldsValue.userPassword?i.default.auth().currentUser.updatePassword(l.state.fieldsValue.userPassword):Promise.resolve()}).then(function(){l.props.onProfileChange(),(0,u.showSuccessMessage)("Профиль обновлен"),l.setState({fieldsError:{},updateError:""})}).catch(function(e){(0,u.showDangerMessage)("Ошибка обновления"),l.setState({updateError:e.message})});case 15:case"end":return e.stop()}},e,this)})),function(e){return l.apply(this,arguments)})},{key:"testForm",value:function(){var e={};return this.state.fieldsValue.userName&&this.state.fieldsValue.userName<3&&(e.userName="Минимальная длина имени 3 символа"),this.state.fieldsValue.userPassword&&this.state.fieldsValue.userPassword.length<8&&(e.userPassword="Минимальная длина пароля 8 символов"),this.state.fieldsValue.confirmPassword!==this.state.fieldsValue.userPassword&&(e.confirmPassword="Пароли не совпадают"),this.state.fieldsValue.userPhoto&&(this.state.fieldsValue.userPhoto.type.includes("image")||(e.userPhoto="Файл должен быть фотографией"),5242880<this.state.fieldsValue.userPhoto.size&&(e.userPhoto="Превышен максимальный размер фото(5Мб)")),e}}]),f);function f(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,e));return t.onFormChange=t.onFormChange.bind(t),t.updateUser=t.updateUser.bind(t),t.state={fieldsValue:{},fieldsError:{},updateError:null},t}d.default=c}).call(this,m(5))},420:function(e,c,f){"use strict";(function(e){Object.defineProperty(c,"__esModule",{value:!0});var t=function(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e};function a(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}f(197),f(83);var r=l(f(84)),n=l(f(198)),s=l(f(401)),o=l(f(402));function l(e){return e&&e.__esModule?e:{default:e}}var u=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(i,e.Component),t(i,[{key:"render",value:function(){return e.createElement("div",{className:"container my-5 row justify-content-center"},e.createElement(n.default,{onAvaChange:this.onProfileChange}),e.createElement("div",{className:"col-sm-6"},e.createElement(s.default,null),e.createElement("div",{className:"btn btn-link","data-toggle":"modal","data-target":"#updateForm"},"Обновить профиль"),e.createElement("div",{className:"modal",role:"dialog",id:"updateForm"},e.createElement("div",{className:"modal-dialog",role:"document"},e.createElement("div",{className:"modal-content"},e.createElement("div",{className:"modal-header d-flex justify-content-end"},e.createElement("span",{"data-dismiss":"modal",className:"cursor"},"×")),e.createElement("div",{className:"modal-body"},e.createElement(o.default,{onProfileChange:this.onProfileChange})))))))}},{key:"onProfileChange",value:function(){this.setState(function(e){return{update:!e.update}})}}]),i);function i(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e));return t.onProfileChange=t.onProfileChange.bind(t),t.state={update:!1},t}c.default=(0,r.default)(u)}).call(this,f(5))},84:function(e,t,u){"use strict";(function(r){Object.defineProperty(t,"__esModule",{value:!0});var a=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e};function n(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var s=e(u(183)),o=e(u(15));u(83),u(186);var l=u(65);function e(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),a(t,[{key:"render",value:function(){return o.default.auth().currentUser?r.createElement(r.Fragment,null,r.createElement(s.default,null),r.createElement(e,null)):r.createElement(l.Redirect,{to:"/"})}}]),t;function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}}}).call(this,u(5))},85:function(e,a,n){"use strict";(function(t){Object.defineProperty(a,"__esModule",{value:!0});var r=n(65);a.default=function(e){return e.error?t.createElement("div",{className:"alert alert-danger"},e.error):""===e.error&&e.successRedirect?t.createElement(r.Redirect,{to:e.successRedirect,push:!0}):""===e.error&&e.successMessage?t.createElement("div",null,e.successMessage):null}}).call(this,n(5))}}]);