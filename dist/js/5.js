(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{121:function(e,t){e.exports="/assets/images/danger.png"},122:function(e,t){e.exports="/assets/images/defAvatar.png"},15:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(r(180)).initializeApp({apiKey:"AIzaSyDdJjjkx2zXC_pIjlW7MtTgU2HvYFrqIqY",authDomain:"forwork-1579542004155.firebaseapp.com",databaseURL:"https://forwork-1579542004155.firebaseio.com",projectId:"forwork-1579542004155",storageBucket:"forwork-1579542004155.appspot.com",messagingSenderId:"591558800067",appId:"1:591558800067:web:41e749971b0784e9302876",measurementId:"G-BBCZS5L5MK"});t.default=n},162:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.historyOrderLoad=function(){return{type:n.ORDERS_LOAD_START}},t.historyOrderSuccess=function(e){return{type:n.ORDERS_LOAD_SUCCESS,payload:e}},t.historyOrderFail=function(e){return{type:n.ORDERS_LOAD_FAIL,error:e}},t.historyOrderAdd=function(e){return{type:n.ORDER_ADD,payload:e}},t.historyOrderChange=function(e){return{type:n.ORDER_CHANGE,payload:e}},t.historyOrderRemove=function(e){return{type:n.ORDER_REMOVE,payload:e}},t.historyDriverChange=function(e){return{type:n.FILTER_DRIVER_CHANGE,payload:e}},t.historyDateStartChange=function(e){return{type:n.FILTER_STARTDATE_CHANGE,payload:e}},t.historyDateEndChange=function(e){return{type:n.FILTER_ENDDATE_CHANGE,payload:e}},t.historyStatusChange=function(e){return{type:n.FILTER_STATUS_CHANGE,payload:e}},t.historySortFieldChange=function(e){return{type:n.SORT_FIELD_CHANGE,payload:e}},t.historySortDirectionChange=function(e){return{type:n.SORT_DIRECTION_CHANGE,payload:e}};var n=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(r(116))},177:function(e,t){e.exports="/assets/images/success.png"},178:function(e,l,i){"use strict";(function(e){Object.defineProperty(l,"__esModule",{value:!0});var t,r=i(61),n=i(31),o=i(15),a=(t=o)&&t.__esModule?t:{default:t};l.default=function(){return e.createElement("div",{className:"d-flex justify-content-between mb-3 p-2 align-items-center"},e.createElement("div",{className:"logo"},e.createElement("img",{src:i(179),alt:"Logo",className:"ml-3 logo-image"})),e.createElement("div",{className:"menu"},e.createElement(r.NavLink,{activeClassName:"active",className:"mr-3",to:"/profile"},"Профиль"),e.createElement(r.NavLink,{activeClassName:"active",className:"mr-3",to:"/history"},"История"),e.createElement(r.NavLink,{activeClassName:"active",to:"/dashboard",className:"mr-3"},"Доска объявлений"),e.createElement("div",{className:"dropdown"},e.createElement("div",{className:"menu-account dropdown-toggle","data-toggle":"dropdown"},e.createElement("img",{src:a.default.auth().currentUser.photoURL||i(122),className:"menu-account-photo"}),e.createElement("div",{className:"menu-account-info"},e.createElement("span",{className:"menu-account-info-name"},a.default.auth().currentUser.displayName))),e.createElement("ul",{className:"dropdown-menu menu-account-content"},e.createElement("li",{className:"dropdown-menu-item menu-account-item"},e.createElement(r.NavLink,{to:"/profile"},"Профиль")),e.createElement("li",{className:"dropdown-menu-item menu-account-item"},e.createElement(r.NavLink,{to:"/profile#updateForm"},"Обновить аккаунт")),e.createElement("li",{className:"dropdown-menu-item menu-account-item"},e.createElement(r.NavLink,{to:"/",onClick:function(){a.default.auth().signOut().catch(function(e){return(0,n.showDangerMessage)(e.message)})}},"Выйти"))))))}}).call(this,i(5))},179:function(e,t){e.exports="/assets/images/logo.jpg"},31:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=null,o=document.querySelector("#message-window"),a=r(177),l=r(121);function i(){o.classList.remove("show"),o.classList.remove("hide"),o.classList.remove("alert-success"),o.classList.remove("alert-danger"),n&&clearTimeout(n),n=setTimeout(function(){o.classList.add("hide")},3500)}t.showSuccessMessage=function(e){i(),o.querySelector(".img").src=a,o.querySelector(".text").textContent=e,o.classList.add("alert-success"),o.querySelector(".img").onload=function(){o.classList.add("show")}},t.showDangerMessage=function(e){i(),o.querySelector(".img").src=l,o.querySelector(".text").textContent=e,o.classList.add("alert-danger"),o.querySelector(".img").onload=function(){o.classList.add("show")}}},406:function(e,m,p){"use strict";(function(o){Object.defineProperty(m,"__esModule",{value:!0});var a=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,a=void 0;try{for(var l,i=e[Symbol.iterator]();!(n=(l=i.next()).done)&&(r.push(l.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{!n&&i.return&&i.return()}finally{if(o)throw a}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},e=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e};function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var t,r=u(p(162)),l=u(p(82)),i=p(15),c=(t=i)&&t.__esModule?t:{default:t},s=p(115);function u(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}var d=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(f,o.Component),e(f,[{key:"componentDidMount",value:function(){var t=this;c.default.database().ref("/auto").once("value",function(e){t.setState({auto:e.val()})})}},{key:"render",value:function(){var t=this;return o.createElement("form",null,o.createElement("div",{className:"form-group"},o.createElement("label",{htmlFor:"driver"},"Водитель:"),o.createElement("select",{name:"driver",className:"custom-select mb-3",value:this.props.historyForm.driver||"",onChange:function(e){return t.props.historyFilterChange(r.historyDriverChange(e.target.value))}},o.createElement("option",{value:""},"Все"),Object.entries(this.state.auto).map(function(e){var t=a(e,2),r=t[0],n=t[1];return o.createElement("option",{value:r,key:r},n.name,"(ID: ",r,")")}))),o.createElement("div",{className:"form-group"},o.createElement("label",{htmlFor:"dateStart"},"Начиная с:"),o.createElement("input",{type:"date",className:"form-control mb-3",placeholder:"Date start",value:this.props.historyForm.dateStart||"",onChange:function(e){return t.props.historyFilterChange(r.historyDateStartChange(e.target.value))}})),o.createElement("div",{className:"form-group"},o.createElement("label",{htmlFor:"dateEnd"},"Заканчивая до:"),o.createElement("input",{type:"date",className:"form-control mb-3",placeholder:"Date end",value:this.props.historyForm.dateEnd||"",onChange:function(e){return t.props.historyFilterChange(r.historyDateEndChange(e.target.value))}})),o.createElement("div",{className:"form-group"},o.createElement("label",{htmlFor:"orderStatus"},"Статус:"),o.createElement("select",{className:"custom-select mb-3",value:this.props.historyForm.status||"",onChange:function(e){return t.props.historyFilterChange(r.historyStatusChange(e.target.value))}},o.createElement("option",{value:""},"Все"),[l.ORDER_FREE,l.ORDER_WAIT,l.ORDER_AUTO,l.ORDER_MOVE,l.ORDER_PAY,l.ORDER_FINISHED].map(function(e,t){return o.createElement("option",{value:e,key:t},e)}))),o.createElement("div",{className:"form-group"},o.createElement("label",{htmlFor:"sortBy"},"Сортировать по:"),o.createElement("select",{className:"custom-select mb-3",value:this.props.historyForm.sortBy||"",onChange:function(e){return t.props.historyFilterChange(r.historySortFieldChange(e.target.value))}},o.createElement("option",{value:"orderCreate"},"Дате создания"),o.createElement("option",{value:"status"},"Статусу"),o.createElement("option",{value:"orderID"},"ID"))),o.createElement("div",{className:"form-group"},o.createElement("label",{htmlFor:"sortDir"},"Порядок сортировки:"),o.createElement("div",{className:"custom-control custom-radio"},o.createElement("input",{type:"radio",className:"custom-control-input",name:"sortDir",value:"ASC",defaultChecked:"ASC"===this.props.historyForm.sortDir,onClick:function(e){return t.props.historyFilterChange(r.historySortDirectionChange(e.target.form.sortDir.value))},style:{zIndex:9999}}),o.createElement("label",{htmlFor:"sortDir",className:"custom-control-label"},"ASC")),o.createElement("div",{className:"custom-control custom-radio"},o.createElement("input",{type:"radio",className:"custom-control-input",name:"sortDir",value:"DESC",onClick:function(e){return t.props.historyFilterChange(r.historySortDirectionChange(e.target.form.sortDir.value))},defaultChecked:"DESC"===this.props.historyForm.sortDir,style:{zIndex:9999}}),o.createElement("label",{className:"custom-control-label",htmlFor:"sortDir"},"DESC"))))}}]),f);function f(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(f.__proto__||Object.getPrototypeOf(f)).call(this,e));return t.state={auto:[]},t}m.default=(0,s.connect)(function(e){return{historyForm:e.history.form}},function(t){return{historyFilterChange:function(e){return t(e)}}})(d)}).call(this,p(5))},407:function(e,d,f){"use strict";(function(t){Object.defineProperty(d,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},e=function(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e};function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var r=c(f(408)),a=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(f(162)),l=c(f(15)),i=f(115);function c(e){return e&&e.__esModule?e:{default:e}}var s=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(u,t.Component),e(u,[{key:"componentDidMount",value:function(){this.props.loadOrders()}},{key:"fetchDate",value:function(e){var t=JSON.stringify(this.props.historyOrders.val,u.DateConvert);switch(e){case"Excel":fetch("http://taxi/api/excel.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},mode:"cors",body:"orders="+t}).then(function(e){e.blob().then(function(e){var t=document.createElement("a");t.href=URL.createObjectURL(e),t.download="history"+ +new Date+".xlsx",document.body.appendChild(t),t.click(),t.remove()})});break;case"PDF":fetch("http://taxi/api/pdf.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},mode:"cors",body:"orders="+t}).then(function(e){e.blob().then(function(e){var t=document.createElement("a");t.href=URL.createObjectURL(e),t.download="history"+ +new Date+".pdf",document.body.appendChild(t),t.click(),t.remove()})})}}},{key:"render",value:function(){var e=this;return this.props.historyOrders.val.length?t.createElement("div",null,t.createElement("div",{className:"row d-flex"},t.createElement("div",{className:"btn btn-primary m-3",onClick:function(){return e.fetchDate("Excel")}},"Excel"),t.createElement("div",{className:"btn btn-primary m-3",onClick:function(){return e.fetchDate("PDF")}},"PDF")),this.props.historyOrders.val.map(function(e){return t.createElement(r.default,{order:e,key:e.orderID})})):t.createElement("div",null,"Записей по данному фильтру не найдено.")}}],[{key:"DateConvert",value:function(e,t){return["orderCreate","orderAccept","orderFinished"].includes(e)?new Date(t).toLocaleString():t}}]),u);function u(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(u.__proto__||Object.getPrototypeOf(u)).apply(this,arguments))}d.default=(0,i.connect)(function(r){var e=r.history.orders.val;return e=(e=(e=(e=e.filter(function(e){return""===r.history.form.driver||+r.history.form.driver==+e.autoID})).filter(function(e){return(!r.history.form.dateStart||e.orderCreate>Date.parse(r.history.form.dateStart))&&(!r.history.form.dateEnd||e.orderCreate<Date.parse(r.history.form.dateEnd))})).filter(function(e){return!r.history.form.status||e.status===r.history.form.status})).sort(function(e,t){return"ASC"===r.history.form.sortDir?e[r.history.form.sortBy]<t[r.history.form.sortBy]:e[r.history.form.sortBy]>t[r.history.form.sortBy]}),{historyOrders:n({},r.history.orders,{val:e})}},function(e){return{loadOrders:function(){e(function(t){l.default.database().ref("/orders").on("child_changed",function(e){e.val().user===l.default.auth().currentUser.uid&&t(a.historyOrderChange(n({orderID:e.key},e.val())))}),l.default.database().ref("/orders").on("child_added",function(e){e.val().user===l.default.auth().currentUser.uid&&t(a.historyOrderAdd(n({orderID:e.key},e.val())))}),l.default.database().ref("/orders").on("child_removed",function(e){e.val().user===l.default.auth().currentUser.uid&&t(a.historyOrderRemove(e.key))})})}}})(s)}).call(this,f(5))},408:function(e,n,o){"use strict";(function(t){Object.defineProperty(n,"__esModule",{value:!0});var r=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}}(o(82));n.default=function(e){return t.createElement("div",{className:"card",key:e.order.orderID},t.createElement("div",{className:"card-body"},t.createElement("div",null,"Заказ №: ",e.order.orderID),t.createElement("div",null,"Начальный адресс: ",e.order.start),t.createElement("div",null,"Конечный адресс: ",e.order.destination),t.createElement("div",null,"Статус: ",e.order.status),t.createElement("div",null,"Создан: ",new Date(e.order.orderCreate).toLocaleString()),function(e){if(e.status!==r.ORDER_FREE)return e.status===r.ORDER_FINISHED?t.createElement("div",null,t.createElement("div",null,"ID водителя: ",e.autoID),t.createElement("div",null,"Дата принятия: ",new Date(e.orderAccept).toLocaleString()),t.createElement("div",null,"Дата завершения: ",new Date(e.orderFinished).toLocaleString()),t.createElement("div",null,"Цена: ",e.price," грн")):t.createElement("div",null,t.createElement("div",null,"ID водителя: ",e.autoID),t.createElement("div",null,"Дата принятия: ",new Date(e.orderAccept).toLocaleString()))}(e.order)))}}).call(this,o(5))},412:function(e,a,l){"use strict";(function(e){Object.defineProperty(a,"__esModule",{value:!0});var t=o(l(80)),r=o(l(406)),n=o(l(407));function o(e){return e&&e.__esModule?e:{default:e}}a.default=(0,t.default)(function(){return e.createElement("div",{className:"container"},e.createElement("div",{className:"row"},e.createElement("div",{className:"col-sm-8"},e.createElement(n.default,null)),e.createElement("div",{className:"col-sm-4"},e.createElement(r.default,null))))})}).call(this,l(5))},80:function(e,t,c){"use strict";(function(r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e};function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=e(c(178)),l=e(c(15));c(79),c(181);var i=c(61);function e(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"render",value:function(){return l.default.auth().currentUser?r.createElement(r.Fragment,null,r.createElement(a.default,null),r.createElement(e,null)):r.createElement(i.Redirect,{to:"/"})}}]),t;function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}}}).call(this,c(5))},82:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AUTO_FREE="Свободен",t.AUTO_ORDER="В пути к заказу",t.AUTO_WAIT="В ожидании",t.AUTO_MOVE="Движется",t.AUTO_PAY="Оплачивается",t.ORDER_FREE="Свободен",t.ORDER_WAIT="В ожидании",t.ORDER_AUTO="В пути к машине",t.ORDER_MOVE="Движется",t.ORDER_PAY="Оплачивается",t.ORDER_FINISHED="Завершен",t.EVENT_TRAVEL="InMove",t.EVENT_PAY="Pay",t.EVENT_WAIT="Wait",t.COST_PER_KM=10,t.COST_BUSY_PER_KM=12.5,t.COST_OFFCITY_PER_KM=20}}]);